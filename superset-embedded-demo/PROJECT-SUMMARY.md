# Superset Embedded Dashboard - é¡¹ç›®æ€»ç»“

## ğŸ“ é¡¹ç›®ç»“æ„

```
superset-embed-demo/
â”œâ”€â”€ config/
â”‚   â””â”€â”€ superset_config_production.py    # Superset ç”Ÿäº§ç¯å¢ƒé…ç½®
â”œâ”€â”€ backend/
â”‚   â”œâ”€â”€ server.js                         # å¼€å‘ç¯å¢ƒ APIï¼ˆå½“å‰è¿è¡Œï¼‰
â”‚   â”œâ”€â”€ server-production.js              # ç”Ÿäº§ç¯å¢ƒ API
â”‚   â”œâ”€â”€ package.json                      # å¼€å‘ä¾èµ–
â”‚   â”œâ”€â”€ package-production.json           # ç”Ÿäº§ä¾èµ–
â”‚   â”œâ”€â”€ .env.example                      # å¼€å‘ç¯å¢ƒå˜é‡ç¤ºä¾‹
â”‚   â””â”€â”€ .env.production.example           # ç”Ÿäº§ç¯å¢ƒå˜é‡ç¤ºä¾‹
â”œâ”€â”€ frontend/
â”‚   â”œâ”€â”€ index.html                        # å¼€å‘ç¯å¢ƒä¸»é¡µé¢
â”‚   â”œâ”€â”€ test.html                         # å¼€å‘ç¯å¢ƒæµ‹è¯•é¡µé¢ï¼ˆå½“å‰ä½¿ç”¨ï¼‰
â”‚   â””â”€â”€ production.html                   # ç”Ÿäº§ç¯å¢ƒé¡µé¢
â”œâ”€â”€ scripts/
â”‚   â””â”€â”€ enable-dashboard-embedded.sh      # å¯ç”¨ Dashboard embedded è„šæœ¬
â”œâ”€â”€ README.md                             # é¡¹ç›®ç®€ä»‹
â”œâ”€â”€ README-COMPLETE.md                    # å®Œæ•´ä½¿ç”¨æŒ‡å—
â””â”€â”€ PRODUCTION-DEPLOYMENT.md              # ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²æŒ‡å—
```

## ğŸ¯ å½“å‰çŠ¶æ€ï¼ˆå¼€å‘ç¯å¢ƒï¼‰

### âœ… å·²å®Œæˆ

1. **Superset é…ç½®**
   - âœ… å¯ç”¨ EMBEDDED_SUPERSET åŠŸèƒ½
   - âœ… é…ç½® EMBEDDED_DOMAINS
   - âœ… ç¦ç”¨ CSRFï¼ˆå¼€å‘ç¯å¢ƒï¼‰
   - âœ… ç¦ç”¨ Talismanï¼ˆå¼€å‘ç¯å¢ƒï¼‰
   - âœ… é…ç½® CORS

2. **åç«¯ API**
   - âœ… Express æœåŠ¡å™¨è¿è¡Œåœ¨ http://localhost:3001
   - âœ… Guest token ç”ŸæˆåŠŸèƒ½
   - âœ… Dashboard åˆ—è¡¨ API
   - âœ… CORS å¼€æ”¾ï¼ˆå¼€å‘ç¯å¢ƒï¼‰

3. **å‰ç«¯ç¤ºä¾‹**
   - âœ… æµ‹è¯•é¡µé¢è¿è¡Œåœ¨ http://localhost:3002/test.html
   - âœ… Dashboard æˆåŠŸåµŒå…¥
   - âœ… è‡ªé€‚åº”å¤§å°
   - âœ… ç”¨æˆ·å‹å¥½çš„æç¤º

4. **Dashboard é…ç½®**
   - âœ… Insurance Fraud Dashboard å·²å¯ç”¨ embedded æ¨¡å¼
   - Dashboard UUID: `6d106529-9f27-4df9-9c9e-50e036a67559`
   - Embedded UUID: `51c5173a-ae1d-4038-b417-22a72c15bb48`

### âš ï¸ å·²çŸ¥é™åˆ¶ï¼ˆå¼€å‘ç¯å¢ƒï¼‰

1. **ç¼–è¾‘æŒ‰é’®å¯è§ä½†æ— æ³•ä½¿ç”¨**
   - åŸå› ï¼šSuperset SDK é™åˆ¶ + è·¨åŸŸé™åˆ¶
   - å½±å“ï¼šGuest ç”¨æˆ·ç‚¹å‡»ç¼–è¾‘ä¼šæ”¶åˆ° 403 é”™è¯¯
   - è§£å†³ï¼šæ·»åŠ äº†ç”¨æˆ·æç¤ºè¯´æ˜

2. **å®‰å…¨é…ç½®ä¸é€‚åˆç”Ÿäº§**
   - CSRF å·²ç¦ç”¨
   - Talisman å·²ç¦ç”¨
   - CORS å®Œå…¨å¼€æ”¾
   - Guest è§’è‰²ä½¿ç”¨ Adminï¼ˆæƒé™è¿‡é«˜ï¼‰

## ğŸš€ ç”Ÿäº§ç¯å¢ƒå‡†å¤‡

### ğŸ“ å·²åˆ›å»ºçš„ç”Ÿäº§ç¯å¢ƒæ–‡ä»¶

1. **Superset é…ç½®**
   - `config/superset_config_production.py`
   - å¯ç”¨æ‰€æœ‰å®‰å…¨ç‰¹æ€§
   - ä¸¥æ ¼çš„ CORS å’Œ CSP
   - Guest è§’è‰²ä½¿ç”¨ Gamma

2. **åç«¯ APIï¼ˆç”Ÿäº§ç‰ˆï¼‰**
   - `backend/server-production.js`
   - Redis ç¼“å­˜
   - é€Ÿç‡é™åˆ¶ï¼ˆ50 æ¬¡/å°æ—¶ï¼‰
   - Helmet å®‰å…¨å¤´
   - è¾“å…¥éªŒè¯
   - é”™è¯¯å¤„ç†

3. **å‰ç«¯ï¼ˆç”Ÿäº§ç‰ˆï¼‰**
   - `frontend/production.html`
   - é”™è¯¯å¤„ç†å’Œé‡è¯•é€»è¾‘
   - ç½‘ç»œçŠ¶æ€ç›‘å¬
   - åŠ è½½çŠ¶æ€æŒ‡ç¤ºå™¨
   - ç”¨æˆ·å‹å¥½çš„é”™è¯¯æç¤º

4. **éƒ¨ç½²æ–‡æ¡£**
   - `PRODUCTION-DEPLOYMENT.md`
   - å®Œæ•´çš„éƒ¨ç½²æ­¥éª¤
   - å®‰å…¨åŠ å›ºæŒ‡å—
   - ç›‘æ§å’Œæ—¥å¿—é…ç½®
   - æ•…éšœæ’æŸ¥æŒ‡å—

### ğŸ” ç”Ÿäº§ç¯å¢ƒå…³é”®å®‰å…¨ç‰¹æ€§

| ç‰¹æ€§ | å¼€å‘ç¯å¢ƒ | ç”Ÿäº§ç¯å¢ƒ |
|------|----------|----------|
| **HTTPS** | âŒ HTTP | âœ… å¼ºåˆ¶ HTTPS |
| **CSRF** | âŒ ç¦ç”¨ | âœ… å¯ç”¨ |
| **Talisman** | âŒ ç¦ç”¨ | âœ… å¯ç”¨ï¼ˆCSPã€HSTSï¼‰ |
| **CORS** | âŒ å¼€æ”¾ | âœ… ä¸¥æ ¼é™åˆ¶ |
| **é€Ÿç‡é™åˆ¶** | âŒ æ—  | âœ… 50/å°æ—¶ |
| **Redis ç¼“å­˜** | âŒ å†…å­˜ | âœ… Redis |
| **è¾“å…¥éªŒè¯** | âŒ åŸºç¡€ | âœ… ä¸¥æ ¼éªŒè¯ |
| **é”™è¯¯ä¿¡æ¯** | âŒ è¯¦ç»† | âœ… é€šç”¨ï¼ˆä¸æ³„éœ²ï¼‰ |
| **æ—¥å¿—** | âŒ Console | âœ… æ–‡ä»¶ + ç›‘æ§ |
| **å¤‡ä»½** | âŒ æ—  | âœ… æ¯æ—¥è‡ªåŠ¨ |

## ğŸ“š ä½¿ç”¨æŒ‡å—

### å¼€å‘ç¯å¢ƒï¼ˆå½“å‰è¿è¡Œï¼‰

**è®¿é—®åœ°å€**ï¼š
- å‰ç«¯ï¼šhttp://localhost:3002/test.html
- åç«¯ APIï¼šhttp://localhost:3001
- Supersetï¼šhttp://localhost:8088

**å¯åŠ¨å‘½ä»¤**ï¼š
```bash
# åç«¯ API
cd ~/Documents/superset-embed-demo/backend
npm start

# å‰ç«¯ï¼ˆå·²è¿è¡Œï¼‰
cd ~/Documents/superset-embed-demo/frontend
python3 -m http.server 3002
```

### æ·»åŠ æ–° Dashboard

```bash
# 1. è·å– Dashboard UUID
curl http://localhost:3001/api/dashboards | python3 -m json.tool

# 2. å¯ç”¨ embedded æ¨¡å¼
cd ~/Documents/superset-embed-demo
./scripts/enable-dashboard-embedded.sh <DASHBOARD_UUID>

# 3. è®°å½•è¿”å›çš„ Embedded UUIDï¼Œåœ¨å‰ç«¯ä½¿ç”¨
```

### ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²

è¯·å‚è€ƒï¼š`PRODUCTION-DEPLOYMENT.md`

## ğŸ› ï¸ æŠ€æœ¯æ ˆ

### åç«¯
- **Express.js** - Web æ¡†æ¶
- **Axios** - HTTP å®¢æˆ·ç«¯
- **Redis** - ç¼“å­˜ï¼ˆç”Ÿäº§ç¯å¢ƒï¼‰
- **express-rate-limit** - é€Ÿç‡é™åˆ¶ï¼ˆç”Ÿäº§ç¯å¢ƒï¼‰
- **Helmet** - å®‰å…¨å¤´ï¼ˆç”Ÿäº§ç¯å¢ƒï¼‰

### å‰ç«¯
- **Superset Embedded SDK** - å®˜æ–¹åµŒå…¥ SDK
- **åŸç”Ÿ JavaScript** - æ— æ¡†æ¶ä¾èµ–

### åŸºç¡€è®¾æ–½ï¼ˆç”Ÿäº§ç¯å¢ƒï¼‰
- **Nginx** - åå‘ä»£ç† + SSL
- **PostgreSQL** - æ•°æ®åº“
- **Redis** - ç¼“å­˜ + ä¼šè¯
- **Let's Encrypt** - SSL è¯ä¹¦
- **systemd** - æœåŠ¡ç®¡ç†

## ğŸ” æ•…éšœæ’æŸ¥

### å¸¸è§é—®é¢˜

1. **Dashboard æ˜¾ç¤º 404**
   - æ£€æŸ¥ Dashboard æ˜¯å¦å·²å¯ç”¨ embedded æ¨¡å¼
   - ç¡®è®¤ä½¿ç”¨æ­£ç¡®çš„ Embedded UUID

2. **Guest Token å¤±è´¥**
   - æ£€æŸ¥ Superset é…ç½®ï¼ˆCSRFã€æƒé™ï¼‰
   - æŸ¥çœ‹åç«¯æ—¥å¿—

3. **ç¼–è¾‘æŒ‰é’®å¯è§**
   - è¿™æ˜¯æ­£å¸¸ç°è±¡
   - Guest ç”¨æˆ·æ²¡æœ‰ç¼–è¾‘æƒé™ï¼ˆ403ï¼‰

4. **ç½‘ç»œé”™è¯¯**
   - æ£€æŸ¥ CORS é…ç½®
   - ç¡®è®¤æœåŠ¡éƒ½åœ¨è¿è¡Œ

### æ—¥å¿—æŸ¥çœ‹

```bash
# åç«¯ API æ—¥å¿—
cat /tmp/claude/tasks/b6ecd9c.output

# Superset æ—¥å¿—
docker logs superset_app

# å‰ç«¯æ—¥å¿—
# æ‰“å¼€æµè§ˆå™¨å¼€å‘è€…å·¥å…·çš„ Console æ ‡ç­¾é¡µ
```

## ğŸ“ ç›¸å…³èµ„æº

- **Superset å®˜æ–¹æ–‡æ¡£**: https://superset.apache.org/docs/embedding-superset
- **Superset GitHub**: https://github.com/apache/superset
- **é¡¹ç›®æ–‡ä»¶**: ~/Documents/superset-embed-demo/

## âœ… ä¸‹ä¸€æ­¥è¡ŒåŠ¨

### å¦‚æœç»§ç»­å¼€å‘
1. æµ‹è¯•æ›´å¤š Dashboard
2. æ·»åŠ ç”¨æˆ·è®¤è¯
3. å®ç° RLSï¼ˆè¡Œçº§å®‰å…¨ï¼‰
4. è‡ªå®šä¹‰ä¸»é¢˜

### å¦‚æœå‡†å¤‡éƒ¨ç½²ç”Ÿäº§
1. é˜…è¯» `PRODUCTION-DEPLOYMENT.md`
2. å‡†å¤‡æœåŠ¡å™¨å’ŒåŸŸå
3. é…ç½® SSL è¯ä¹¦
4. æŒ‰æ­¥éª¤éƒ¨ç½²
5. è¿›è¡Œå®‰å…¨å®¡è®¡

## ğŸ‰ æ€»ç»“

ä½ ç°åœ¨æ‹¥æœ‰ï¼š
- âœ… **å®Œæ•´çš„å¼€å‘ç¯å¢ƒ**ï¼ˆæ­£åœ¨è¿è¡Œï¼‰
- âœ… **ç”Ÿäº§ç¯å¢ƒé…ç½®**ï¼ˆéšæ—¶å¯éƒ¨ç½²ï¼‰
- âœ… **è¯¦ç»†çš„æ–‡æ¡£**ï¼ˆä¸‰ä»½æ–‡æ¡£ï¼‰
- âœ… **å®‰å…¨æœ€ä½³å®è·µ**ï¼ˆç”Ÿäº§å°±ç»ªï¼‰
- âœ… **è„šæœ¬å·¥å…·**ï¼ˆè‡ªåŠ¨åŒ–æ“ä½œï¼‰

**é¡¹ç›®çŠ¶æ€**ï¼šå¼€å‘ç¯å¢ƒå®Œå…¨é…ç½®ï¼Œç”Ÿäº§ç¯å¢ƒé…ç½®æ–‡ä»¶å·²å‡†å¤‡å¥½ï¼Œå¯ä»¥éšæ—¶éƒ¨ç½²ï¼
