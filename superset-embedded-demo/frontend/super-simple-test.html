<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>è¶…ç®€å•æµ‹è¯•</title>
    <style>
        body { font-family: monospace; padding: 20px; background: #000; color: #0f0; }
        #log { background: #111; padding: 20px; border: 2px solid #0f0; margin-top: 20px; }
        .msg { margin: 10px 0; padding: 10px; background: #222; border-left: 3px solid #0f0; }
    </style>
</head>
<body>
    <h1>ğŸ”¬ è¶…ç®€å•æ¶ˆæ¯æµ‹è¯•</h1>
    <p>è¿™ä¸ªé¡µé¢åªåšä¸€ä»¶äº‹ï¼šæ˜¾ç¤ºæ‰€æœ‰ postMessage</p>

    <button onclick="test()" style="background: #0f0; color: #000; padding: 10px 20px; border: none; cursor: pointer;">
        å‘é€æµ‹è¯•æ¶ˆæ¯
    </button>

    <div id="log">
        <div class="msg">âœ… ç­‰å¾…æ¶ˆæ¯...</div>
    </div>

    <script>
        let count = 0;

        function addLog(msg, isAI = false) {
            const div = document.createElement('div');
            div.className = 'msg';
            div.style.borderLeftColor = isAI ? '#ff0' : '#0f0';
            div.innerHTML = `<strong>[${++count}]</strong> ${msg}`;
            document.getElementById('log').appendChild(div);
        }

        function test() {
            window.postMessage({ type: 'ai-question', payload: 'test' }, '*');
            addLog('ğŸ“¤ å‘é€äº†æµ‹è¯•æ¶ˆæ¯');
        }

        window.addEventListener('message', (e) => {
            const data = e.data;

            if (!data) {
                addLog('ğŸ“­ æ”¶åˆ°ç©ºæ¶ˆæ¯');
                return;
            }

            if (typeof data !== 'object') {
                addLog('ğŸ“­ æ”¶åˆ°éå¯¹è±¡æ¶ˆæ¯: ' + data);
                return;
            }

            if (data.type === 'ai-question') {
                addLog(`ğŸ‰ æ”¶åˆ° AI æ¶ˆæ¯!<br>ğŸ’¬ å†…å®¹: "${data.payload}"<br>ğŸ“ æ¥æº: ${e.origin}`, true);
            } else {
                addLog(`ğŸ“¨ æ”¶åˆ°å…¶ä»–æ¶ˆæ¯<br>ç±»å‹: ${data.type}<br>æ¥æº: ${e.origin}`);
            }
        }, true);  // ä½¿ç”¨æ•è·é˜¶æ®µ

        addLog('âœ… ç›‘å¬å™¨å·²å°±ç»ª');
    </script>
</body>
</html>
